@page "/"
@page "/StateManagement"


@inject CounterStore counterStore


<button class="btn btn-primary" @onclick="IncrementCount">Click me</button>

<br />
<br />


<p>  Current Count: @currentCount   </p>


<p>  Counter Store: @counterStore.GetState().Count   </p>


@code {
    private int currentCount = 0;


    protected override void OnInitialized()
    {
        base.OnInitialized();

        counterStore.AddStateChangeListeners(UpdateView);

    }


    private void IncrementCount()
    {
        currentCount += 2;

        counterStore.IncrementCount();

    }



    //fix memory leaking. 
    public void Dispose()
    {
        counterStore.RemoveStateChangeListeners(UpdateView);
    }


    private void UpdateView()
    {
        StateHasChanged();
    }
}
